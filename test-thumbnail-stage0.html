<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é˜¶æ®µ0æµ‹è¯• - æ—¶é—´è½´ç¼©ç•¥å›¾</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
        #console {
            background: #000;
            color: #0f0;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            height: 300px;
            overflow-y: auto;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ğŸ¬ æ—¶é—´è½´ç¼©ç•¥å›¾ - é˜¶æ®µ0éªŒæ”¶æµ‹è¯•</h1>
    
    <div class="test-section">
        <h3>æ­¥éª¤ 0.1ï¼šç¯å¢ƒæ£€æŸ¥</h3>
        <button onclick="testEnvironment()">è¿è¡Œç¯å¢ƒæ£€æŸ¥</button>
        <div id="envResult"></div>
    </div>
    
    <div class="test-section">
        <h3>æ­¥éª¤ 0.2ï¼šåŠŸèƒ½å¼€å…³æµ‹è¯•</h3>
        <button onclick="testEnable()">å¯ç”¨åŠŸèƒ½</button>
        <button onclick="testDisable()">ç¦ç”¨åŠŸèƒ½</button>
        <button onclick="testConfig()">æŸ¥çœ‹é…ç½®</button>
        <div id="switchResult"></div>
    </div>
    
    <div class="test-section">
        <h3>æ­¥éª¤ 0.3ï¼šç›®å½•ç»“æ„éªŒè¯</h3>
        <button onclick="testStructure()">éªŒè¯ç›®å½•ç»“æ„</button>
        <div id="structureResult"></div>
    </div>
    
    <div class="test-section">
        <h3>æ§åˆ¶å°è¾“å‡º</h3>
        <div id="console"></div>
    </div>
    
    <script>
        // æ‹¦æˆªconsole.log
        const consoleDiv = document.getElementById('console');
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            consoleDiv.innerHTML += message + '<br>';
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        };
        
        function testEnvironment() {
            console.log('=== ç¯å¢ƒæ£€æŸ¥æµ‹è¯• ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const config = thumbnailInitializer.getConfig();
                console.log('âœ… ThumbnailInitializer å·²åŠ è½½');
                console.log('é…ç½®çŠ¶æ€:', {
                    enabled: config.enabled,
                    version: config.version,
                    fallbackToDom: config.fallbackToDom
                });
                document.getElementById('envResult').innerHTML = 
                    '<p style="color: #4CAF50;">âœ… ç¯å¢ƒæ£€æŸ¥é€šè¿‡</p>';
            } else {
                console.log('âŒ ThumbnailInitializer æœªåŠ è½½');
                document.getElementById('envResult').innerHTML = 
                    '<p style="color: #f44336;">âŒ ç¯å¢ƒæ£€æŸ¥å¤±è´¥</p>';
            }
        }
        
        function testEnable() {
            console.log('=== å¯ç”¨åŠŸèƒ½æµ‹è¯• ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const result = thumbnailInitializer.enable();
                document.getElementById('switchResult').innerHTML = 
                    `<p style="color: ${result ? '#4CAF50' : '#ff9800'};">
                        ${result ? 'âœ… åŠŸèƒ½å·²å¯ç”¨' : 'âš ï¸ åŠŸèƒ½å¯ç”¨ä½†ç¯å¢ƒæ£€æŸ¥å¤±è´¥ï¼ˆå·²é™çº§ï¼‰'}
                    </p>`;
            }
        }
        
        function testDisable() {
            console.log('=== ç¦ç”¨åŠŸèƒ½æµ‹è¯• ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                thumbnailInitializer.disable();
                document.getElementById('switchResult').innerHTML = 
                    '<p style="color: #ff9800;">â¸ï¸ åŠŸèƒ½å·²ç¦ç”¨</p>';
            }
        }
        
        function testConfig() {
            console.log('=== é…ç½®æŸ¥çœ‹æµ‹è¯• ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const config = thumbnailInitializer.getConfig();
                console.log('å½“å‰é…ç½®:', config);
                document.getElementById('switchResult').innerHTML = 
                    '<p style="color: #2196F3;">ğŸ“‹ é…ç½®å·²è¾“å‡ºåˆ°æ§åˆ¶å°</p>';
            }
        }
        
        function testStructure() {
            console.log('=== ç›®å½•ç»“æ„éªŒè¯ ===');
            const expectedFiles = [
                'src/phaser/timeline/ThumbnailConfig.js',
                'src/phaser/timeline/ThumbnailInitializer.js',
                'src/phaser/timeline/scenes/',
                'src/phaser/timeline/gameobjects/',
                'src/phaser/timeline/utils/',
                'src/phaser/utils/EnvironmentChecker.js'
            ];
            console.log('é¢„æœŸæ–‡ä»¶ç»“æ„:', expectedFiles);
            document.getElementById('structureResult').innerHTML = 
                '<p style="color: #4CAF50;">âœ… ç›®å½•ç»“æ„å·²åˆ›å»ºï¼ˆè§æ§åˆ¶å°ï¼‰</p>';
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œç¯å¢ƒæ£€æŸ¥
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('ğŸš€ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹è‡ªåŠ¨æµ‹è¯•...\n');
                testEnvironment();
            }, 1000);
        });
    </script>
    
    <!-- åŠ è½½ä¸»åº”ç”¨ï¼ˆåŒ…å«ThumbnailInitializerï¼‰ -->
    <script src="lib/phaser.min.js"></script>
    <script type="module">
        import ThumbnailInitializer from './src/phaser/timeline/ThumbnailInitializer.js';
        import EnvironmentChecker from './src/phaser/utils/EnvironmentChecker.js';
        
        // åˆ›å»ºä¸´æ—¶gameå®ä¾‹ç”¨äºæµ‹è¯•
        const testConfig = {
            type: Phaser.HEADLESS,
            width: 800,
            height: 600
        };
        const game = new Phaser.Game(testConfig);
        
        // åˆ›å»ºåˆå§‹åŒ–å™¨
        window.thumbnailInitializer = new ThumbnailInitializer(game);
        window.EnvironmentChecker = EnvironmentChecker;
        
        console.log('âœ… æµ‹è¯•ç¯å¢ƒå·²å‡†å¤‡å°±ç»ª');
    </script>
</body>
</html>
