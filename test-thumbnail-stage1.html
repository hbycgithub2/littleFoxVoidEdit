<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é˜¶æ®µ1æµ‹è¯• - æ¶æ„è°ƒç ”</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #4CAF50;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #45a049;
        }
        #console {
            background: #000;
            color: #0f0;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            height: 400px;
            overflow-y: auto;
            border-radius: 4px;
        }
        .info {
            background: #1e3a5f;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #2196F3;
        }
    </style>
</head>
<body>
    <h1>ğŸ” æ—¶é—´è½´ç¼©ç•¥å›¾ - é˜¶æ®µ1æ¶æ„è°ƒç ”æµ‹è¯•</h1>
    
    <div class="info">
        <strong>è¯´æ˜ï¼š</strong>æœ¬é¡µé¢ç”¨äºæµ‹è¯•æ¶æ„åˆ†æåŠŸèƒ½ï¼Œæ‰€æœ‰åˆ†æç»“æœå°†è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚
    </div>
    
    <div class="test-section">
        <h3>æ­¥éª¤ 1.1ï¼šPhaseræ¶æ„åˆ†æ</h3>
        <button onclick="testPhaserAnalysis()">åˆ†æPhaseræ¶æ„</button>
        <div id="phaserResult"></div>
    </div>
    
    <div class="test-section">
        <h3>æ­¥éª¤ 1.2ï¼šDOMæ—¶é—´è½´åˆ†æ</h3>
        <button onclick="testDOMAnalysis()">åˆ†æDOMæ—¶é—´è½´</button>
        <div id="domResult"></div>
    </div>
    
    <div class="test-section">
        <h3>æ­¥éª¤ 1.3ï¼šé›†æˆæ–¹æ¡ˆå†³ç­–</h3>
        <button onclick="testIntegrationStrategy()">ç¡®å®šé›†æˆæ–¹æ¡ˆ</button>
        <div id="strategyResult"></div>
    </div>
    
    <div class="test-section">
        <h3>å®Œæ•´åˆ†æ</h3>
        <button onclick="runFullAnalysis()">è¿è¡Œå®Œæ•´æ¶æ„åˆ†æ</button>
        <button onclick="testEventBridge()">æµ‹è¯•äº‹ä»¶æ¡¥æ¥</button>
        <div id="fullResult"></div>
    </div>
    
    <div class="test-section">
        <h3>æ§åˆ¶å°è¾“å‡º</h3>
        <button onclick="clearConsole()">æ¸…ç©ºæ§åˆ¶å°</button>
        <div id="console"></div>
    </div>
    
    <!-- æ¨¡æ‹Ÿè§†é¢‘å…ƒç´  -->
    <video id="video" style="display:none;" width="640" height="360">
        <source src="assets/videos/001_I_Can_Hop.mp4" type="video/mp4">
    </video>
    
    <!-- æ¨¡æ‹Ÿæ—¶é—´è½´Canvas -->
    <canvas id="timelineCanvas" style="display:none;" width="800" height="100"></canvas>
    
    <script>
        // æ‹¦æˆªconsole.log
        const consoleDiv = document.getElementById('console');
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            consoleDiv.innerHTML += '<span style="color: #0f0;">' + message + '</span><br>';
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            consoleDiv.innerHTML += '<span style="color: #f44;">' + message + '</span><br>';
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        };
        
        function clearConsole() {
            consoleDiv.innerHTML = '';
        }
        
        function testPhaserAnalysis() {
            console.log('=== æµ‹è¯•Phaseræ¶æ„åˆ†æ ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const analyzer = thumbnailInitializer.analyzer;
                const result = analyzer.analyzePhaserArchitecture();
                document.getElementById('phaserResult').innerHTML = 
                    '<p style="color: #4CAF50;">âœ… Phaseræ¶æ„åˆ†æå®Œæˆï¼ˆè§æ§åˆ¶å°ï¼‰</p>';
            } else {
                console.error('âŒ ThumbnailInitializeræœªåŠ è½½');
            }
        }
        
        function testDOMAnalysis() {
            console.log('=== æµ‹è¯•DOMæ—¶é—´è½´åˆ†æ ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const analyzer = thumbnailInitializer.analyzer;
                const result = analyzer.analyzeDOMTimeline();
                document.getElementById('domResult').innerHTML = 
                    '<p style="color: #4CAF50;">âœ… DOMæ—¶é—´è½´åˆ†æå®Œæˆï¼ˆè§æ§åˆ¶å°ï¼‰</p>';
            } else {
                console.error('âŒ ThumbnailInitializeræœªåŠ è½½');
            }
        }
        
        function testIntegrationStrategy() {
            console.log('=== æµ‹è¯•é›†æˆæ–¹æ¡ˆå†³ç­– ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const analyzer = thumbnailInitializer.analyzer;
                const strategy = analyzer.determineIntegrationStrategy();
                const decisions = analyzer.makeTechnicalDecisions();
                document.getElementById('strategyResult').innerHTML = 
                    '<p style="color: #4CAF50;">âœ… é›†æˆæ–¹æ¡ˆå·²ç¡®å®šï¼ˆè§æ§åˆ¶å°ï¼‰</p>';
            } else {
                console.error('âŒ ThumbnailInitializeræœªåŠ è½½');
            }
        }
        
        function runFullAnalysis() {
            console.log('=== è¿è¡Œå®Œæ•´æ¶æ„åˆ†æ ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const results = thumbnailInitializer.analyzeArchitecture();
                document.getElementById('fullResult').innerHTML = 
                    '<p style="color: #4CAF50;">âœ… å®Œæ•´åˆ†æå®Œæˆï¼ˆè§æ§åˆ¶å°ï¼‰</p>' +
                    '<p style="color: #2196F3;">ğŸ’¡ ä½¿ç”¨ thumbnailInitializer.analyzer.getResults() è·å–ç»“æœ</p>';
            } else {
                console.error('âŒ ThumbnailInitializeræœªåŠ è½½');
            }
        }
        
        function testEventBridge() {
            console.log('=== æµ‹è¯•äº‹ä»¶æ¡¥æ¥ ===');
            if (typeof thumbnailInitializer !== 'undefined') {
                const bridge = thumbnailInitializer.getEventBridge();
                
                // æµ‹è¯•äº‹ä»¶ç›‘å¬
                bridge.on('video-loaded', (data) => {
                    console.log('âœ… æ”¶åˆ°video-loadedäº‹ä»¶:', data);
                });
                
                // æ¨¡æ‹Ÿå‘é€äº‹ä»¶
                window.dispatchEvent(new CustomEvent('video:loaded', {
                    detail: { duration: 120, width: 640, height: 360 }
                }));
                
                // æµ‹è¯•è¯·æ±‚è§†é¢‘ä¿¡æ¯
                bridge.requestVideoInfo().then(info => {
                    console.log('ğŸ“º è§†é¢‘ä¿¡æ¯:', info);
                });
                
                document.getElementById('fullResult').innerHTML = 
                    '<p style="color: #4CAF50;">âœ… äº‹ä»¶æ¡¥æ¥æµ‹è¯•å®Œæˆï¼ˆè§æ§åˆ¶å°ï¼‰</p>';
            } else {
                console.error('âŒ ThumbnailInitializeræœªåŠ è½½');
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œ
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('ğŸš€ é˜¶æ®µ1æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ\n');
                console.log('ğŸ’¡ æç¤º: ç‚¹å‡»æŒ‰é’®è¿è¡Œå„é¡¹æµ‹è¯•');
            }, 1000);
        });
    </script>
    
    <!-- åŠ è½½ä¸»åº”ç”¨ -->
    <script src="lib/phaser.min.js"></script>
    <script type="module" src="src/main.js"></script>
</body>
</html>
